#Permutation by Rows - 1000 output job
library(qtl2)

#Read in inputs
apr <- readRDS("./DO2_alleleprob.rds")
phen <- readRDS("./samp1000.rds")
kLOCO <- readRDS("./DO2_kLOCO.rds")
covar <- readRDS("./addcovar.rds")

#Intialize array id - array = 246
args<-as.integer(unlist(strsplit(commandArgs(TRUE)," ")))
print(args)

arrayid <-args[1]
print(arrayid)

ncore <- args[2]
print(ncore)

perms <- args[3]
print(perms)

#Run the permutation test
permOut <- scan1perm(apr, phen[,arrayid, drop = FALSE],
                     kinship = kLOCO,
                     addcovar = covar, 
                     n_perm = perms,
                     cores = ncore)

saveRDS(permOut, file = paste0("permOut_row",arrayid,".rds"))






























































































































































































































